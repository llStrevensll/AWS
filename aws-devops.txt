install CLI
https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html

cli aws  v2
https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html
C:\Program Files\Amazon\AWSCLIV2

aws -


aws console:
IAM
   Users
	Security credentials
	  Create access key


configure:
aws configure
https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html

C:\Users\USERNAME\.aws\credentials on Windows.

~/.aws/config on Linux or macOS, 


$ aws configure
AWS Access Key ID [None]: AKIAIOSFODNN7EXAMPLE
AWS Secret Access Key [None]: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
Default region name [None]: us-west-2
Default output format [None]: json

Comment:
https://stackoverflow.com/questions/43217469/how-do-you-comment-out-lines-in-aws-cli-config-and-credentials-files#:~:text=1%20Answer&text=You%20can%20comment%20lines%20by%20using%20the%20%23%20character%2C%20e.g.


=============================
CodeCommit

https://docs.aws.amazon.com/codecommit/latest/userguide/setting-up-ssh-windows.html



ssh-keygen
   C:\Users\user/.ssh/id_rsa_aws_educate


aws console:
IAM
   Users
	Security credentials
	  Upload ssh key

//edit config
Host git-codecommit.*.amazonaws.com
  User <id_ssh_codecommit>
  IdentityFile ~/.ssh/id_rsa_aws_ss


ssh git-codecommit.us-east-2.amazonaws.com


git clone ssh://git-codecommit.us-east-1.amazonaws.com/v1/repos/my_demoaws

git add .
git commit -m ""
git push

--
https://www.atlassian.com/git/tutorials/using-branches
--
git checkout -b my-feature

git add .
git commit -m ""
git push

git push --set-upstream origin my-feature

create pull request
	Destination:master       Source:my-feature	Compare
 

merge strategy

Fast forward merge
git merge --ff-only
 Merges the brances and moves the destination branch pointer to the tip
 of the source branch. This is the default merge strategy in git

Squash and merge
git merge --squash
Combines all commits from the source branch into a single merge commit in the destination
branch

3-way merge
git merge --no-ff
Creates a merge commit and adds individual source commits to the destination branch

--
check delete source branch

--
Securing the repository and branches
https://docs.aws.amazon.com/codecommit/latest/userguide/auth-and-access-control.html#auth-and-access-control-iam-access-control-identity-based
https://docs.aws.amazon.com/codecommit/latest/userguide/how-to-conditional-branch.html

create inline policie - json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Deny",
            "Action": [
                "codecommit:GitPush",
                "codecommit:DeleteBranch",
                "codecommit:PutFile",
                "codecommit:MergeBranchesByFastForward",
                "codecommit:MergeBranchesBySquash",
                "codecommit:MergeBranchesByThreeWay",
                "codecommit:MergePullRequestByFastForward",
                "codecommit:MergePullRequestBySquash",
                "codecommit:MergePullRequestByThreeWay"
            ],
            "Resource": "arn:aws:codecommit:us-east-2:111111111111:MyDemoRepo",
            "Condition": {
                "StringEqualsIfExists": {
                    "codecommit:References": [
                        "refs/heads/main", 
                        "refs/heads/prod"
                     ]
                },
                "Null": {
                    "codecommit:References": "false"
                }
            }
        }
    ]
}


git push
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 16 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 359 bytes | 359.00 KiB/s, done.
Total 3 (delta 1), reused 0 (delta 0), pack-reused 0
Access denied: You don't have permission to push changes to this branch.
To ssh://git-codecommit.us-east-1.amazonaws.com/v1/repos/my_demoaws
 ! [remote rejected] master -> master (You don't have permission to push changes to this branch.)
error: failed to push some refs to 'ssh://git-codecommit.us-east-1.amazonaws.com/v1/repos/my_demoaws'



--
Notification
aws-codecommit - settings
  create notification rule
  
  create trigger

Amazon SNS
{
  "Version": "2008-10-17",
  "Statement": [
    {
      "Sid": "CodeNotification_publish",
      "Effect": "Allow",
      "Principal": {
        "Service": "codestar-notifications.amazonaws.com"
      },
      "Action": "SNS:Publish",
      "Resource": "arn:aws:sns:us-east-1:1111111:codecommit-notifications-test"
    }
  ]
}


---
aws cloudwatch
Events
	rules

{
  "source": [
    "aws.codecommit"
  ],
  "detail-type": [
    "CodeCommit Repository State Change"
  ]
}

